#include <SoftwareSerial.h>
#define MOT_A1_PIN 3
#define MOT_A2_PIN A0
#define MOT_A3_PIN 5
#define MOT_A4_PIN A5
#define MOT_A5_PIN 6
#define MOT_A6_PIN A4
#define MOT_A7_PIN 9
#define MOT_A8_PIN A3
#define MOT_A9_PIN 11
#define MOT_A10_PIN A1
#define MOT_A11_PIN 10
#define MOT_A12_PIN A2
SoftwareSerial mySerial(7, 8); // RX, TX

void forward(int pwm, int A1, int A2, int A3, int A4);
void back(int pwm, int A1, int A2, int A3, int A4);
void right(int pwm, int A1, int A2, int A3, int A4);
void left(int pwm, int A1, int A2, int A3, int A4);
int pwm=0;
char data;
void setup() {
  // Open serial communications and wait for port to open:
    Serial.begin(9600);
  while (!Serial) {
    ; // wait for serial port to connect. Needed for native USB port only
  }
  // set the data rate for the SoftwareSerial port
  mySerial.begin(9600);
  pinMode(MOT_A1_PIN, OUTPUT);
  pinMode(MOT_A2_PIN, OUTPUT);
  pinMode(MOT_A3_PIN, OUTPUT);
  pinMode(MOT_A4_PIN, OUTPUT);
  pinMode(MOT_A5_PIN, OUTPUT);
  pinMode(MOT_A6_PIN, OUTPUT);
  pinMode(MOT_A7_PIN, OUTPUT);
  pinMode(MOT_A8_PIN, OUTPUT);
  pinMode(MOT_A9_PIN, OUTPUT);
  pinMode(MOT_A10_PIN, OUTPUT);
  pinMode(MOT_A11_PIN, OUTPUT);
  pinMode(MOT_A12_PIN, OUTPUT);
  // Start with drivers off, motors coasting.
  digitalWrite(MOT_A1_PIN, LOW);
  digitalWrite(MOT_A2_PIN, LOW);
  digitalWrite(MOT_A3_PIN, LOW);
  digitalWrite(MOT_A4_PIN, LOW);
  digitalWrite(MOT_A5_PIN, LOW);
  digitalWrite(MOT_A6_PIN, LOW);
  digitalWrite(MOT_A7_PIN, LOW);
  digitalWrite(MOT_A8_PIN, LOW);
  digitalWrite(MOT_A9_PIN, LOW);
  digitalWrite(MOT_A10_PIN, LOW);
  digitalWrite(MOT_A11_PIN, LOW);
  digitalWrite(MOT_A12_PIN, LOW);

}

void loop() { // run over and over
  if (mySerial.available()) {
    data = mySerial.read();
    Serial.println(data);
    if (data == '0') {
      pwm=0;
    }
    else if (data == '1') {
      pwm=25;
    }
    else if (data == '2') {
      pwm=50;
    }
    else if (data == '3') {
      pwm=80;
    }
    else if (data == '4') {
      pwm=100;
    }
    else if (data == '5') {
      pwm=125;
    }
    else if (data == '6') {
      pwm=150;
    }
    else if (data == '7') {
      pwm=175;
    }
    else if (data == '8') {
      pwm=200;
    }
    else if (data == '9') {
      pwm=255;
    }
    
    else if (data == 'F') {
          forward(pwm, MOT_A1_PIN, MOT_A2_PIN, MOT_A3_PIN, MOT_A4_PIN);
          forward(pwm, MOT_A5_PIN, MOT_A6_PIN, MOT_A7_PIN, MOT_A8_PIN);
          forward(pwm, MOT_A9_PIN, MOT_A10_PIN, MOT_A11_PIN, MOT_A12_PIN);//Ехать вперёд
    }
    else if(data == 'B') {
          back(pwm, MOT_A1_PIN, MOT_A2_PIN, MOT_A3_PIN, MOT_A4_PIN);
          back(pwm, MOT_A5_PIN, MOT_A6_PIN, MOT_A7_PIN, MOT_A8_PIN);
          back(pwm, MOT_A9_PIN, MOT_A10_PIN, MOT_A11_PIN, MOT_A12_PIN);//Ехать назад
    }
    else if(data == 'R') {
          right(pwm, MOT_A1_PIN, MOT_A2_PIN, MOT_A3_PIN, MOT_A4_PIN);
          right(pwm, MOT_A5_PIN, MOT_A6_PIN, MOT_A7_PIN, MOT_A8_PIN);
          right(pwm, MOT_A9_PIN, MOT_A10_PIN, MOT_A11_PIN, MOT_A12_PIN);//Поворот направо
    }
    else if(data == 'L') {
          left(pwm, MOT_A1_PIN, MOT_A2_PIN, MOT_A3_PIN, MOT_A4_PIN);
          left(pwm, MOT_A5_PIN, MOT_A6_PIN, MOT_A7_PIN, MOT_A8_PIN);
          left(pwm, MOT_A9_PIN, MOT_A10_PIN, MOT_A11_PIN, MOT_A12_PIN);//Поворот налево
    }
}
    else {
      back(0, MOT_A1_PIN, MOT_A2_PIN, MOT_A3_PIN, MOT_A4_PIN);
      back(0, MOT_A5_PIN, MOT_A6_PIN, MOT_A7_PIN, MOT_A8_PIN);
      back(0, MOT_A9_PIN, MOT_A10_PIN, MOT_A11_PIN, MOT_A12_PIN);//Остановиться
    }
    delay(10);
}
void forward(int pwm, int A1, int A2, int A3, int A4){ 

    analogWrite(A1, 255-pwm);
    digitalWrite(A2, 1);
    analogWrite(A3, 255-pwm);
    digitalWrite(A4, 1);

}
void back(int pwm, int A1, int A2, int A3, int A4){ 
  
    analogWrite(A1, pwm);
    digitalWrite(A2, 0);
    analogWrite(A3, pwm);
    digitalWrite(A4, 0);

}
void left(int pwm, int A1, int A2, int A3, int A4){
  
    analogWrite(A1 , 255-pwm);
    digitalWrite(A2, 1);
    analogWrite(A3 , pwm);
    digitalWrite(A4, 0);

}
void right(int pwm, int A1, int A2, int A3, int A4){

    analogWrite(A1 , pwm);
    digitalWrite(A2, 0);
    analogWrite(A3 , 255-pwm);
    digitalWrite(A4, 1);

}